<!doctype html>
<html lang="en">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width,initial-scale=1" />
<title>Water Use Visualization</title>

<style>
:root{
  --bg:#f5f7f6;
  --card:#ffffff;
  --muted:#6b7280;

  /* ESRT-ish palette (swap to exact brand hex if you have it) */
  --esrt-green:#00594c;
  --esrt-blue:#007fa3;

  --glass-stroke:#cfd8dc;
}

body{
  margin:0;
  font-family: Inter, system-ui, -apple-system, "Segoe UI", Roboto, Arial;
  background:var(--bg);
  display:flex;
  align-items:center;
  justify-content:center;
  min-height:100vh;
  padding:40px;
}

.module{
  width:980px;
  max-width:100%;
  background:#fff;
  border-radius:14px;
  box-shadow:0 8px 30px rgba(0,0,0,0.05);
  padding:40px;
  display:flex;
  gap:60px;
  align-items:center;
  flex-wrap:wrap;
}

.glass-card{ padding:10px; }

.info{
  flex:1;
  min-width:260px;
  display:flex;
  flex-direction:column;
  gap:16px;
}

.title{ font-size:20px; font-weight:600; color:var(--esrt-green); }
.subtitle{ font-size:14px; color:var(--muted); }

.stats-row{ display:flex; gap:24px; flex-wrap:wrap; }

.stat{ min-width:220px; }

.big{ font-size:32px; font-weight:700; color:var(--esrt-green); }
.small{ font-size:14px; color:var(--muted); }

.meter{
  height:10px;
  background:#e6f2f4;
  border-radius:6px;
  overflow:hidden;
  margin-top:8px;
}
.meter-fill{
  height:100%;
  width:0%;
  background:linear-gradient(90deg,var(--esrt-green),var(--esrt-blue));
  transition:width 1.4s cubic-bezier(.2,.9,.3,1);
}

/* Gentle surface wobble: subtle + seamless */
@keyframes surfaceWobble {
  0%   { transform: translateX(0px); }
  50%  { transform: translateX(-9px); }
  100% { transform: translateX(0px); }
}
.surface-line{
  animation: surfaceWobble 3.8s ease-in-out infinite;
  transform-origin: 50% 50%;
}

@media (max-width:820px){
  .module{ flex-direction:column; }
}
</style>
</head>

<body>
<div class="module">

  <!-- PINT GLASS -->
  <div class="glass-card">
    <svg viewBox="0 0 220 360" width="220" height="360" xmlns="http://www.w3.org/2000/svg" role="img" aria-label="Pint glass showing water level">
      <defs>
        <!-- Pint glass: slightly tapered, straight-ish sides, thicker base -->
        <path id="pintShape"
          d="M70 24
             Q70 16 110 16
             Q150 16 150 24
             L165 300
             Q166 318 110 332
             Q54 318 55 300
             Z"/>

        <clipPath id="clipPint">
          <use href="#pintShape"/>
        </clipPath>

        <!-- Water gradient: calmer, less "shiny" -->
        <linearGradient id="waterGrad" x1="0" x2="0" y1="0" y2="1">
          <stop offset="0%" stop-color="#1aa0c6" stop-opacity="0.85"/>
          <stop offset="100%" stop-color="#007fa3" stop-opacity="0.95"/>
        </linearGradient>

        <!-- Subtle glass reflection gradient (NOT on the water) -->
        <linearGradient id="glassShine" x1="0" x2="1" y1="0" y2="0">
          <stop offset="0%" stop-color="rgba(255,255,255,0.00)"/>
          <stop offset="30%" stop-color="rgba(255,255,255,0.32)"/>
          <stop offset="55%" stop-color="rgba(255,255,255,0.10)"/>
          <stop offset="100%" stop-color="rgba(255,255,255,0.00)"/>
        </linearGradient>

        <!-- Subtle rim highlight -->
        <linearGradient id="rimGrad" x1="0" x2="0" y1="0" y2="1">
          <stop offset="0%" stop-color="rgba(255,255,255,0.85)"/>
          <stop offset="100%" stop-color="rgba(255,255,255,0.0)"/>
        </linearGradient>
      </defs>

      <!-- Glass fill (transparent) -->
      <use href="#pintShape"
           fill="rgba(255,255,255,0.16)"
           stroke="var(--glass-stroke)"
           stroke-width="3"
           stroke-linejoin="round"/>

      <!-- Rim line (pint glass feel) -->
      <path d="M76 24 L144 24"
            stroke="url(#rimGrad)"
            stroke-width="5"
            stroke-linecap="round"
            opacity="0.8"/>

      <!-- Inner lip -->
      <path d="M78 28 L142 28"
            stroke="rgba(255,255,255,0.35)"
            stroke-width="2"
            stroke-linecap="round"
            opacity="0.9"/>

      <!-- Base thickness -->
      <path d="M58 306
               Q60 323 110 336
               Q160 323 162 306"
            fill="none"
            stroke="rgba(210,220,224,0.9)"
            stroke-width="8"
            stroke-linecap="round"
            opacity="0.85"/>

      <!-- WATER (clipped) -->
      <g clip-path="url(#clipPint)">
        <rect id="waterRect"
              x="0"
              y="300"
              width="220"
              height="0"
              fill="url(#waterGrad)"/>

        <!-- water surface: just a wavy line, no "shine" blocks -->
        <g id="surfaceGroup" class="surface-line" opacity="0">
          <path d="M62 0
                   C82 -3, 96 3, 110 0
                   C124 -3, 138 3, 158 0"
                fill="none"
                stroke="rgba(255,255,255,0.70)"
                stroke-width="2.1"
                stroke-linecap="round"/>
          <path d="M62 4
                   C82 1, 96 7, 110 4
                   C124 1, 138 7, 158 4"
                fill="none"
                stroke="rgba(0,0,0,0.07)"
                stroke-width="2"
                stroke-linecap="round"
                opacity="0.55"/>
        </g>
      </g>

      <!-- Glass reflections (on glass, not water) -->
      <path d="M86 42 L98 292"
            stroke="url(#glassShine)"
            stroke-width="12"
            stroke-linecap="round"
            opacity="0.65"/>

      <path d="M104 40 L110 295"
            stroke="rgba(255,255,255,0.18)"
            stroke-width="4"
            stroke-linecap="round"
            opacity="0.75"/>

    </svg>

    <div style="margin-top:14px;text-align:center">
      <div id="glassPercent" style="font-size:20px;font-weight:700;color:var(--esrt-green)">-6.15%</div>
      <div style="font-size:14px;color:var(--muted)">decrease vs 2023</div>
    </div>
  </div>

  <!-- INFO -->
  <div class="info">
    <div>
      <div class="title">2024 NYC Commercial Office Water Use</div>
      <div class="subtitle">Visualization of change and intensity for 2024</div>
    </div>

    <div class="stats-row">
      <div class="stat">
        <div class="big"><span id="percentValue">0.00</span>%</div>
        <div class="small">Decrease in water consumption compared to 2023</div>
      </div>

      <div class="stat">
        <div class="big"><span id="intensityValue">0.000</span> kgal/ftÂ²</div>
        <div class="small">2024 water use intensity</div>
        <div class="meter"><div id="meterFill" class="meter-fill"></div></div>
      </div>
    </div>
  </div>

</div>

<script>
const percentDecrease = 6.15;
const intensityVal = 0.153;

// Empty -> about half -> down by 6.15% of baseline
const baselineFill = 0.50;
const finalFill = baselineFill * (1 - percentDecrease/100);

const waterRect = document.getElementById('waterRect');
const surfaceGroup = document.getElementById('surfaceGroup');
const meterFill = document.getElementById('meterFill');

const INNER_TOP = 28;     // inside rim
const INNER_BOTTOM = 300; // top of base
const INNER_HEIGHT = INNER_BOTTOM - INNER_TOP;

function easeOut(t){ return 1 - Math.pow(1-t,3); }

function setWater(level){
  level = Math.max(0, Math.min(1, level));
  const h = INNER_HEIGHT * level;
  const y = INNER_BOTTOM - h;

  waterRect.setAttribute('y', y);
  waterRect.setAttribute('height', h);

  // surface line sits on the boundary
  surfaceGroup.setAttribute('transform', `translate(0, ${y})`);
  surfaceGroup.style.opacity = (h <= 1) ? "0" : "1";
}

function animate(from,to,duration,cb,done){
  const start = performance.now();
  function step(now){
    const t = Math.min((now-start)/duration, 1);
    cb(from + (to-from)*easeOut(t));
    if(t < 1) requestAnimationFrame(step);
    else if(done) done();
  }
  requestAnimationFrame(step);
}

function animateNumber(id,end,dec){
  const el = document.getElementById(id);
  const start = performance.now();
  function step(now){
    const t = Math.min((now-start)/1400, 1);
    el.textContent = (end*easeOut(t)).toFixed(dec);
    if(t < 1) requestAnimationFrame(step);
  }
  requestAnimationFrame(step);
}

function run(){
  setWater(0);

  animate(0, baselineFill, 1100, setWater, () => {
    setTimeout(() => animate(baselineFill, finalFill, 900, setWater), 250);
  });

  animateNumber("percentValue", percentDecrease, 2);
  animateNumber("intensityValue", intensityVal, 3);

  const maxForMeter = 0.6;
  meterFill.style.width = Math.min(100, (intensityVal / maxForMeter) * 100) + "%";
}

const mq = window.matchMedia('(prefers-reduced-motion: reduce)');
if (mq.matches) {
  document.getElementById('percentValue').textContent = percentDecrease.toFixed(2);
  document.getElementById('intensityValue').textContent = intensityVal.toFixed(3);
  setWater(finalFill);
  meterFill.style.width = Math.min(100, (intensityVal / 0.6) * 100) + "%";
  surfaceGroup.classList.remove('surface-line');
} else {
  setTimeout(run, 200);
}
</script>

</body>
</html>
