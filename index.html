<!doctype html>
<html lang="en">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width,initial-scale=1" />
<title>Water Use Visualization</title>

<style>
:root{
  --bg:#f4f8f7;
  --card:#ffffff;
  --muted:#6b7280;
  --accent:#007c6f;
  --water:#1fa3d6;
}
body{
  margin:0;
  font-family: Inter, system-ui, -apple-system, "Segoe UI", Roboto, Arial;
  background:var(--bg);
  display:flex;
  align-items:center;
  justify-content:center;
  min-height:100vh;
  padding:40px;
}
.module{
  width:980px;
  max-width:100%;
  background:linear-gradient(180deg,#fff 0%,#fafcfb 100%);
  border-radius:16px;
  box-shadow:0 10px 30px rgba(12,18,20,0.06);
  padding:28px;
  display:flex;
  gap:28px;
  align-items:center;
  flex-wrap:wrap;
}
.visual{ display:flex; gap:18px; align-items:center; }

.bottle-card{
  background:var(--card);
  padding:14px;
  border-radius:12px;
  box-shadow:0 6px 18px rgba(4,8,10,0.06);
  text-align:center;
}

/* Waterfall drops (no text) */
.falls{
  width:80px;
  display:flex;
  align-items:center;
  justify-content:center;
}
.drops{
  width:60px;
  height:220px;
  position:relative;
  overflow:hidden;
}
.drop{
  position:absolute;
  width:10px;
  height:18px;
  border-radius:12px;
  background:linear-gradient(180deg,var(--water),#087ea8);
  animation:drop-fall linear infinite;
}
.drop.d1{ left:14px; animation-duration:1.1s; }
.drop.d2{ left:26px; animation-duration:1.4s; animation-delay:.2s;}
.drop.d3{ left:38px; animation-duration:1.25s; animation-delay:.45s;}
.drop.d4{ left:6px;  animation-duration:1.6s; animation-delay:.9s;}

@keyframes drop-fall{
  0%{ transform:translateY(-40%); opacity:0;}
  10%{opacity:1;}
  90%{opacity:.6;}
  100%{ transform:translateY(420%); opacity:0;}
}

/* Right side */
.info{
  flex:1;
  min-width:260px;
  display:flex;
  flex-direction:column;
  gap:12px;
}
.title{ font-size:18px; font-weight:600; }
.subtitle{ font-size:13px; color:var(--muted); }

.stats-row{
  display:flex;
  gap:18px;
  flex-wrap:wrap;
}
.stat{
  background:var(--card);
  padding:12px 14px;
  border-radius:10px;
  box-shadow:0 6px 16px rgba(6,10,12,0.04);
  min-width:180px;
}
.big{
  font-size:28px;
  font-weight:700;
  color:var(--accent);
}
.small{ font-size:13px; color:var(--muted); }

.meter{
  height:10px;
  background:#e6f6fb;
  border-radius:8px;
  overflow:hidden;
  margin-top:8px;
}
.meter-fill{
  height:100%;
  width:0%;
  background:linear-gradient(90deg,var(--water),#087ea8);
  transition:width 1.4s cubic-bezier(.2,.9,.3,1);
}

@media (max-width:820px){
  .falls{ display:none; }
}
</style>
</head>

<body>

<div class="module">
  <div class="visual">

    <!-- Waterfall drops (no text) -->
    <div class="falls">
      <div class="drops">
        <div class="drop d1"></div>
        <div class="drop d2"></div>
        <div class="drop d3"></div>
        <div class="drop d4"></div>
      </div>
    </div>

    <!-- Bottle -->
    <div class="bottle-card">
      <svg viewBox="0 0 200 360" width="200" height="360" xmlns="http://www.w3.org/2000/svg">

        <defs>
          <!-- Single continuous bottle shape -->
          <path id="bottleShape"
            d="M70 20
               Q70 10 85 10
               L115 10
               Q130 10 130 20
               L130 60
               Q130 70 120 75
               L120 300
               Q120 330 100 330
               Q80 330 80 300
               L80 75
               Q70 70 70 60
               Z" />

          <clipPath id="clipBottle">
            <use href="#bottleShape"/>
          </clipPath>

          <linearGradient id="waterGrad" x1="0" x2="0" y1="0" y2="1">
            <stop offset="0%" stop-color="#3cc9f0"/>
            <stop offset="100%" stop-color="#087ea8"/>
          </linearGradient>

          <path id="wavePath"
            d="M0 20 Q25 0 50 20 T100 20 T150 20 T200 20 V60 H0 Z"/>
        </defs>

        <!-- Outline -->
        <use href="#bottleShape"
             fill="none"
             stroke="#d6eaea"
             stroke-width="4"/>

        <!-- Water -->
        <g clip-path="url(#clipBottle)">
          <rect id="waterRect"
                x="0"
                y="300"
                width="200"
                height="0"
                fill="url(#waterGrad)"
                opacity="0.95"/>

          <g id="waveGroup">
            <use href="#wavePath" id="wave1"
                 fill="#1fa3d6" opacity="0.9"/>
            <use href="#wavePath" id="wave2"
                 fill="#0f8fbf" opacity="0.5"/>
          </g>
        </g>

      </svg>

      <div style="margin-top:10px">
        <div id="bottlePercent"
             style="font-size:20px;font-weight:700;color:var(--accent)">
          -6.15%
        </div>
        <div style="font-size:13px;color:var(--muted)">
          decrease vs 2023
        </div>
      </div>
    </div>
  </div>

  <div class="info">
    <div>
      <div class="title">2024 NYC Commercial Office Water Use</div>
      <div class="subtitle">
        Visualization of change and intensity for 2024
      </div>
    </div>

    <div class="stats-row">
      <div class="stat">
        <div class="big">
          <span id="percentValue">0.00</span>%
        </div>
        <div class="small">
          Decrease in water consumption compared to 2023
        </div>
      </div>

      <div class="stat">
        <div class="big">
          <span id="intensityValue">0.000</span> kgal/ftÂ²
        </div>
        <div class="small">
          2024 water use intensity
        </div>
        <div class="meter">
          <div id="meterFill" class="meter-fill"></div>
        </div>
      </div>
    </div>
  </div>
</div>

<script>
const percentDecrease = 6.15;
const intensityVal = 0.153;

const baselineFill = 0.50;
const finalFill = baselineFill * (1 - percentDecrease/100);

const waterRect = document.getElementById('waterRect');
const waveGroup = document.getElementById('waveGroup');
const wave1 = document.getElementById('wave1');
const wave2 = document.getElementById('wave2');
const meterFill = document.getElementById('meterFill');

const INNER_TOP = 75;
const INNER_BOTTOM = 300;
const INNER_HEIGHT = INNER_BOTTOM - INNER_TOP;

function easeOut(t){ return 1 - Math.pow(1-t,3); }

function setWater(level){
  const h = INNER_HEIGHT * level;
  const y = INNER_BOTTOM - h;
  waterRect.setAttribute('y', y);
  waterRect.setAttribute('height', h);
  waveGroup.setAttribute('transform', `translate(0, ${y-20})`);
}

function animate(from,to,duration,cb){
  const start=performance.now();
  function step(now){
    const t=Math.min((now-start)/duration,1);
    cb(from+(to-from)*easeOut(t));
    if(t<1) requestAnimationFrame(step);
  }
  requestAnimationFrame(step);
}

function animateNumber(id,end,decimals){
  const el=document.getElementById(id);
  const start=performance.now();
  function step(now){
    const t=Math.min((now-start)/1400,1);
    const v=end*easeOut(t);
    el.textContent=v.toFixed(decimals);
    if(t<1) requestAnimationFrame(step);
  }
  requestAnimationFrame(step);
}

function run(){
  setWater(0);

  animate(0,baselineFill,1000,setWater);
  setTimeout(()=>animate(baselineFill,finalFill,800,setWater),1200);

  animateNumber("percentValue",percentDecrease,2);
  animateNumber("intensityValue",intensityVal,3);

  meterFill.style.width=(intensityVal/0.6*100)+"%";

  let waveX=0;
  function moveWave(){
    waveX+=0.6;
    wave1.setAttribute("x",(waveX%200)-200);
    wave2.setAttribute("x",((waveX*0.7)%200)-200);
    requestAnimationFrame(moveWave);
  }
  moveWave();
}

setTimeout(run,200);
</script>

</body>
</html>
